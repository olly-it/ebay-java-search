package it.olly.ebay.api;

import org.junit.jupiter.api.Test;

import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;

import it.olly.ebay.api.model.AuthResponse;
import it.olly.ebay.api.model.BrowseItemSummeryResponse;

public class TestJson {

    @Test
    public void deserializeAuthResponse() throws Exception {
        String resp = """
                {
                    "access_token": "v^1.1#i^1 ... BxIAAA==",
                    "expires_in": 7200,
                    "token_type": "Application Access Token"
                }
                """;

        ObjectMapper om = new ObjectMapper();
        om.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);

        AuthResponse value = om.readValue(resp, AuthResponse.class);

        System.out.println("auth> " + value);
    }

    @Test
    public void deserializeSearchResponse() throws Exception {
        String resp = """
                {"href":"https://api.ebay.com/buy/browse/v1/item_summary/search?q=drone&limit=3&offset=0","total":141438,"next":"https://api.ebay.com/buy/browse/v1/item_summary/search?q=drone&limit=3&offset=3","limit":3,"offset":0,"itemSummaries":[{"itemId":"v1|305809838633|0","title":"Drone Xiaomi Mija Z908Max 8K GPS Professionale HD Fotografia Aerea Dual Camera","leafCategoryIds":["179697"],"categories":[{"categoryId":"179697","categoryName":"Droni per riprese video"},{"categoryId":"625","categoryName":"Fotografia e video"}],"image":{"imageUrl":"https://i.ebayimg.com/images/g/XJIAAOSwYJtmx2sN/s-l225.jpg"},"price":{"value":"75.00","currency":"EUR"},"itemHref":"https://api.ebay.com/buy/browse/v1/item/v1%7C305809838633%7C0","seller":{"username":"pixelmarketshop","feedbackPercentage":"87.9","feedbackScore":25,"sellerAccountType":"INDIVIDUAL"},"condition":"Nuovo","conditionId":"1000","thumbnailImages":[{"imageUrl":"https://i.ebayimg.com/images/g/XJIAAOSwYJtmx2sN/s-l1200.jpg"}],"shippingOptions":[{"shippingCostType":"FIXED","shippingCost":{"value":"0.00","currency":"EUR"}}],"buyingOptions":["FIXED_PRICE"],"itemAffiliateWebUrl":"https://www.ebay.it/itm/305809838633?_skw=drone&hash=item4733afd229%3Ag%3AXJIAAOSwYJtmx2sN&amdata=enc%3AAQAJAAAA4H%2FqIbIc6o8B4%2BvpFzQyE8UiCDH3P5flfxWAPTZtp8DB6yftC3yL%2FCHt3vXqfEEItUPeLBc0y9l8vduBOXFC%2FEsZYImxt8GkOTOHdT9Y0ILE3arnI7j%2FSYx6Ljf%2B%2FcJDEQU9Re%2FM10SsFZ8FKpQdGKsmxY6yPUH%2F2NQfFNu%2BlrUyTTaX%2FnyCYRV%2Faw%2BSLHA3hx8CwEDq%2BMKict8QJTtFsFKkjVRUHVJRGYz4f6pP7yjhiZpkFVt3FnRLyT6SbDr0%2F1RAOsYWWoMIxkaetc7G5%2B0IcM5oL3V%2FExceXOONBPkd&mkevt=1&mkcid=1&mkrid=724-53478-19255-0&campid=5339087417&customid=5838019&toolid=10049","itemWebUrl":"https://www.ebay.it/itm/305809838633?_skw=drone&hash=item4733afd229:g:XJIAAOSwYJtmx2sN&amdata=enc%3AAQAJAAAA4H%2FqIbIc6o8B4%2BvpFzQyE8UiCDH3P5flfxWAPTZtp8DB6yftC3yL%2FCHt3vXqfEEItUPeLBc0y9l8vduBOXFC%2FEsZYImxt8GkOTOHdT9Y0ILE3arnI7j%2FSYx6Ljf%2B%2FcJDEQU9Re%2FM10SsFZ8FKpQdGKsmxY6yPUH%2F2NQfFNu%2BlrUyTTaX%2FnyCYRV%2Faw%2BSLHA3hx8CwEDq%2BMKict8QJTtFsFKkjVRUHVJRGYz4f6pP7yjhiZpkFVt3FnRLyT6SbDr0%2F1RAOsYWWoMIxkaetc7G5%2B0IcM5oL3V%2FExceXOONBPkd","itemLocation":{"postalCode":"90***","country":"IT"},"additionalImages":[{"imageUrl":"https://i.ebayimg.com/images/g/5IQAAOSwHvhmx2sO/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/UnwAAOSwgyBmx2sP/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/vksAAOSwuHZmx2sQ/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/7JoAAOSw7GVmx2sS/s-l225.jpg"}],"adultOnly":false,"legacyItemId":"305809838633","availableCoupons":false,"itemCreationDate":"2024-08-22T16:47:05.000Z","topRatedBuyingExperience":false,"priorityListing":true,"listingMarketplaceId":"EBAY_IT"},{"itemId":"v1|235432697922|0","title":"DRONE QUADRICOTTERO PROFESSIONALE GPS PIEGHEVOLE CON TELECAMERA 4K BORSA WIFI","leafCategoryIds":["123847"],"categories":[{"categoryId":"123847","categoryName":"Elicotteri"},{"categoryId":"220","categoryName":"Giocattoli e modellismo"},{"categoryId":"2562","categoryName":"Radiocomandati e giocattoli"},{"categoryId":"182181","categoryName":"Modellini radiocomandati e kit"}],"image":{"imageUrl":"https://i.ebayimg.com/images/g/ffsAAOSwoNVlza0J/s-l225.jpg"},"price":{"value":"139.95","currency":"EUR"},"itemHref":"https://api.ebay.com/buy/browse/v1/item/v1%7C235432697922%7C0","seller":{"username":"2014.deast","feedbackPercentage":"100.0","feedbackScore":4085,"sellerAccountType":"BUSINESS"},"condition":"Nuovo","conditionId":"1000","thumbnailImages":[{"imageUrl":"https://i.ebayimg.com/images/g/ffsAAOSwoNVlza0J/s-l960.jpg"}],"shippingOptions":[{"shippingCostType":"FIXED","shippingCost":{"value":"0.00","currency":"EUR"}}],"buyingOptions":["FIXED_PRICE","BEST_OFFER"],"itemAffiliateWebUrl":"https://www.ebay.it/itm/235432697922?_skw=drone&hash=item36d0e1e042%3Ag%3AffsAAOSwoNVlza0J&amdata=enc%3AAQAJAAAA4H%2FqIbIc6o8B4%2BvpFzQyE8W%2F8r8gWRA1fDsFg1NtbHDr%2Bq3PqQI8h2hrxl8dbdqN4x5n5RqiefaAxnXA%2FI27K1cJskOPaGQLqaRNvbu862dLS%2BXZ5BmApgYH%2FMI77FnTN1z2cELqWQEs%2B5wEi0GaMnxz%2FKsCEHjWVEXQt7aCHKJDaHzZ1nHExKjma2J0GeFWOWhd3vAa2QVq8qLGp7f2JibojAeSe9V1zQe1M4A5K4ja80Lw9HlhFnAVPFqmffB%2FZZ4x0oi65YigCFc2HwbNKS2T6wQbIwzQqMrGXRW1OHGK&mkevt=1&mkcid=1&mkrid=724-53478-19255-0&campid=5339087417&customid=5838019&toolid=10049","itemWebUrl":"https://www.ebay.it/itm/235432697922?_skw=drone&hash=item36d0e1e042:g:ffsAAOSwoNVlza0J&amdata=enc%3AAQAJAAAA4H%2FqIbIc6o8B4%2BvpFzQyE8W%2F8r8gWRA1fDsFg1NtbHDr%2Bq3PqQI8h2hrxl8dbdqN4x5n5RqiefaAxnXA%2FI27K1cJskOPaGQLqaRNvbu862dLS%2BXZ5BmApgYH%2FMI77FnTN1z2cELqWQEs%2B5wEi0GaMnxz%2FKsCEHjWVEXQt7aCHKJDaHzZ1nHExKjma2J0GeFWOWhd3vAa2QVq8qLGp7f2JibojAeSe9V1zQe1M4A5K4ja80Lw9HlhFnAVPFqmffB%2FZZ4x0oi65YigCFc2HwbNKS2T6wQbIwzQqMrGXRW1OHGK","itemLocation":{"postalCode":"70***","country":"IT"},"additionalImages":[{"imageUrl":"https://i.ebayimg.com/images/g/cUEAAOSwpLVlza0J/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/GmoAAOSwlydlza0I/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/L1AAAOSwC-1lza0N/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/JcYAAOSwIw1lza0U/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/MjQAAOSwq49lza0a/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/Gv4AAOSwGixlza0P/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/8GAAAOSwJ~hlza0U/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/zgoAAOSwuaplza0S/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/WdkAAOSw7hdlza0Q/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/oO4AAOSwN8Jlza0a/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/HaQAAOSwqo9lza0R/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/t0sAAOSwA~Nlza0T/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/x98AAOSwi5hlza0W/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/aosAAOSwjQJlza0Q/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/NcMAAOSwXbJlza0U/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/tSoAAOSwNqBlza0T/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/avgAAOSwkPtlza0R/s-l225.jpg"}],"adultOnly":false,"legacyItemId":"235432697922","availableCoupons":false,"itemCreationDate":"2024-02-15T06:25:18.000Z","topRatedBuyingExperience":true,"priorityListing":true,"listingMarketplaceId":"EBAY_IT"},{"itemId":"v1|186516278946|0","title":"Drone Snaptain SP650 1080P FULLHD Videocamera WIFI FPV Controllo Vocale 360Â°","leafCategoryIds":["182185"],"categories":[{"categoryId":"182185","categoryName":"Quadricotteri e multicotteri"},{"categoryId":"220","categoryName":"Giocattoli e modellismo"},{"categoryId":"2562","categoryName":"Radiocomandati e giocattoli"},{"categoryId":"182181","categoryName":"Modellini radiocomandati e kit"}],"image":{"imageUrl":"https://i.ebayimg.com/images/g/6scAAOSwOj9merbf/s-l225.jpg"},"price":{"value":"38.90","currency":"EUR"},"itemHref":"https://api.ebay.com/buy/browse/v1/item/v1%7C186516278946%7C0","seller":{"username":"fusion-computer","feedbackPercentage":"100.0","feedbackScore":3632,"sellerAccountType":"BUSINESS"},"condition":"Nuovo","conditionId":"1000","thumbnailImages":[{"imageUrl":"https://i.ebayimg.com/images/g/6scAAOSwOj9merbf/s-l500.jpg"}],"shippingOptions":[{"shippingCostType":"FIXED","shippingCost":{"value":"0.00","currency":"EUR"}}],"buyingOptions":["FIXED_PRICE"],"itemAffiliateWebUrl":"https://www.ebay.it/itm/186516278946?_skw=drone&hash=item2b6d3c8ea2%3Ag%3A6scAAOSwOj9merbf&amdata=enc%3AAQAJAAAA4H%2FqIbIc6o8B4%2BvpFzQyE8XmaIOTML4HUV4chbYSCLPpvc2kpH7MjXajmkUr1hIVb1sJWqTcmXdvUUxCpv2YInpie2VgaFWN2qQUuL251sWx6vlEOBgv1DigLUUt2zsY8cJCE9%2BQEVn33tlF0JzbgRwfEQs3H2tS18RkWEJ9pFucDjodnAy%2BZamGVHyhM3SOUs3uSr8U%2FKSWJCOlY2C7jQ%2F5zmQoM%2F%2BUSI%2FC49dtC5kBHUm%2FxYgzDnYswmn9rBIW%2Fh8C%2BNJKP%2BQ4a4NTAKHg3o%2BznW0F8h7eXQPIXAS0494m&mkevt=1&mkcid=1&mkrid=724-53478-19255-0&campid=5339087417&customid=5838019&toolid=10049","itemWebUrl":"https://www.ebay.it/itm/186516278946?_skw=drone&hash=item2b6d3c8ea2:g:6scAAOSwOj9merbf&amdata=enc%3AAQAJAAAA4H%2FqIbIc6o8B4%2BvpFzQyE8XmaIOTML4HUV4chbYSCLPpvc2kpH7MjXajmkUr1hIVb1sJWqTcmXdvUUxCpv2YInpie2VgaFWN2qQUuL251sWx6vlEOBgv1DigLUUt2zsY8cJCE9%2BQEVn33tlF0JzbgRwfEQs3H2tS18RkWEJ9pFucDjodnAy%2BZamGVHyhM3SOUs3uSr8U%2FKSWJCOlY2C7jQ%2F5zmQoM%2F%2BUSI%2FC49dtC5kBHUm%2FxYgzDnYswmn9rBIW%2Fh8C%2BNJKP%2BQ4a4NTAKHg3o%2BznW0F8h7eXQPIXAS0494m","itemLocation":{"postalCode":"37***","country":"IT"},"additionalImages":[{"imageUrl":"https://i.ebayimg.com/images/g/XDYAAOSwjChmerbf/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/E-AAAOSwOYRmerbg/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/DwAAAOSwsl5merbf/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/CfgAAOSwcrJmerca/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/4S0AAOSwdVFmerio/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/4wQAAOSwg6Bmerbf/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/TgIAAOSwvZtmerbg/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/rwoAAOSw4EFmerbe/s-l225.jpg"},{"imageUrl":"https://i.ebayimg.com/images/g/yogAAOSwaVRmerio/s-l225.jpg"}],"adultOnly":false,"legacyItemId":"186516278946","availableCoupons":false,"itemCreationDate":"2024-06-25T12:31:46.000Z","topRatedBuyingExperience":true,"priorityListing":true,"listingMarketplaceId":"EBAY_IT"}]}
                """;

        ObjectMapper om = new ObjectMapper();
        om.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, false);

        BrowseItemSummeryResponse value = om.readValue(resp, BrowseItemSummeryResponse.class);

        System.out.println("search> " + value);
    }
}
